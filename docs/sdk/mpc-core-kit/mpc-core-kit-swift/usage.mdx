---
title: "Usage of MPC Core Kit Swift SDK"
sidebar_label: "Usage"
description: "Web3Auth MPC Core Kit Swift SDK - Usage | Documentation - Web3Auth"
---

Once you've installed and successfully initialized `MpcCoreKit`, you can use it to authenticate your
users, add factors to their account, generate TSS signatures for transactions and interact with the
blockchain.

## Functionality Overview

| Method Name                                    | Description                                                                                                              |
| ---------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| [loginWithJWT](#log-in-with-jwt)               | Logs in the user with a JWT-based ID Token. We recommend using this method to authenticate users for better performance. |
| [loginWithOAuth](#log-in-with-oauth)           | Logs in the user using OAuth Flow, this function underneaths uses the CustomAuth flow to authenticate the user.          |
| [inputFactorKey](#log-in-with-existing-factor) | This method can be used to login with the exisitng factor key, for instance when threshold is not satisfied.             |
| [logout](#logout)                              | This methods logs out the user and invalidates the session.                                                              |

:::info Get help with Authentication

Check out the [**Authentication**](/sdk/mpc-core-kit/mpc-core-kit-ios/authentication) section of the
SDK Reference to learn more about these functions.

:::

### Manual Sync Method

This method enables you to have a fined grained control over the API calls made to the metadata
server from the SDK.

| Method Name                      | Description                                                                                                                                                                                              |
| -------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [commitChanges](#commit-changes) | Commits the changes made to the user's account while in manual sync mode. To use this function, you'll need to enable the manual sync while [configuring the instance](./initialize#configure-instance). |

### Factor Handling Methods

| Method Name                                    | Description                                                                                                                                                                                                          |
| ---------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [enableMFA](#enable-mfa)                       | By default, the SDK starts with 2/2 flow unless the `disableHashedFactorKey` is set to true during initialisation. To make the flow completely non-custodial, and have 2/3 flow, you can use the enableMFA function. |
| [createFactor](#create-factor)                 | Creates a new TSS Factor for the user's account to increase. You can configure the type of factor, it can either be a device factor, or backup factor.                                                               |
| [deleteFactor](#delete-factor)                 | This method allows you to deletes a TSS factor for the user. Please make sure user has enough factors to recover the account.                                                                                        |
| [getCurrentFactorKey](#get-current-factor-key) | This methods returns the current factor key used along with social factor to log in.                                                                                                                                 |
| [getDeviceFactor](#get-device-factor)          | This methods returns the device factor if available.                                                                                                                                                                 |
| [setDeviceFactor](#set-device-factor)          | This methods allows you to set the device factor for the user.                                                                                                                                                       |
| [getAllFactorPubs](#get-all-factor-pubs)       | This methods returns the list of all factor pub keys for the user's account.                                                                                                                                         |

### User & Wallet Account Methods

| Method Name                            | Description                                                                                                        |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------------------ |
| [getPubKey](#get-secp256k1-public-key) | Returns the TSS PubKey in SEC1 format which can be used for the secp256k1 curve to derive the EOA address.         |
| [getUserInfo](#get-user-info)          | Returns the user information such as name, verifier, email, and other details.                                     |
| [getKeyDetails](#get-key-details)      | Returns the key details for the user account, these key details has information like total factors, and threshold. |

### Additional Helper Methods

| Method Name                       | Description                                                                                   |
| --------------------------------- | --------------------------------------------------------------------------------------------- |
| [mnemonicToKey](#mnemonic-to-key) | This method helps you to convert 24 word mnemonic(seed phrase) into corresponding factor key. |
| [keyToMnemonic](#key-to-mnemonic) | This method helps you to convert the factor key to corresponding 24 mnemonic.                 |

## Authentication Methods

### Log in with OAuth

This method helps to log in the user using Single Page Application (SPA) flow. You can choose your
preferred social auth providers with 0Auth login flow. Please refer to the
[authentication section](/sdk/mpc-core-kit/mpc-core-kit-ios/authentication/login-oauth) section for
more details.

### Log in with JWT

Logs in the user with a JWT-based ID Token. We recommend using this method to authenticate users for
better performance. For this method, you'll have to manage the authentication yourself, and Web3Auth
will only verify the idToken passed. Please refer to the
[authentication section](/sdk/mpc-core-kit/mpc-core-kit-ios/authentication/login-jwt) for more
details.

### Log in with Existing Factor

This method can be used to input the factor key, for instance when threshold is not satisfied. For
example, if user's device factor is not present, this method can be used to input the back up factor
key, and recover the account. If the factor key is correct, the SDK initializes the user's account
and logs them in.

If you want to change the factor key in the current state of the SDK, you can use this method.
Please make sure to convert your factor key to BN before passing it to this method.

The function takes the factor key in HEX format as an argument.

```swift
do {
  // Use the existing MPCCoreKit instance
  try await mpcCoreKit.inputFactor(
    factorKey: "FACTOR_KEY_IN_HEX"
  )
} catch {
    // Handle error
}
```

### Logout

This method logs out the user, and invalidates the session.

```swift
do {
  // Use the existing MPCCoreKit instance
  try await mpcCoreKit.logout();
} catch {
  // Handle error
}
```

## Manual Sync Method

### Commit Changes

This method helps you syncs the local metadata with the Web3Auth's Metadata server. This function is
only to be used while in manual sync mode. This enables you to have a fined grained control over the
API calls made to the metadata server from the SDK.

It is especially useful when you want to handle the factors and keys of the user's account in a more
controlled manner, enabling a much faster and safer experience for the User.

Please note that if you don't commit the local changes, the user's account will not sync with the
metadata server, and any changes will be lost when the app is closed.

```swift
do {
  // Use the existing MPCCoreKit instance
  try await mpcCoreKit.commitChanges();
} catch {
  // Handle error
}
```

## Factor Handling Methods

### Enable MFA

By default, the SDK starts with semi-custodial 2/2 flow unless the `disableHashedFactorKey` is set
to true during initialisation. To make the flow completely non-custodial, and have 2/3 flow, you can
use the enableMFA method.

It creates a device factor and stores it in the local storage. Along with that, it also creates a
backup factor and returns it to the user. The default backup factor is 24 words mnemonic. You can
configure the backup factor to be social recovery, password recovery, authenticator app, or back up
of your choice.

Most importantly, this method also deletes the Hashed Factor Key enabling a non-custodial flow. The
method takes in `MFARecoveryFactor` which allows you to configure the backup factor of your choice.

#### MFARecoveryFactor Parameters

| Name                    | Description                                                                                                                                                                                                                    |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `factorKey?`            | A new hex string to be used for the back up factor. You can pass the hex generated from social recovery, or any other back up factor like authenticator app. By default, a random BN is generated and converted to hex format. |
| `factorTypeDescription` | The share description to be stored in Metadata. Default value is `.Other`. Available values are `.HashedShare`,`.SecurityQuestions`, `.DeviceShare`, `.SeedPhrase`, `.PasswordShare`, `.SocialShare`, and `.Other`             |
| `additionalMetadata`    | You can use this parameter if you wish to store additional metadata for the factor.                                                                                                                                            |

#### Usage

```swift
do {
  // Use the existing MPCCoreKit instance
  let backupFactor = try await mpcCoreKit.enableMFA()
} catch {
  // Handle error
}
```

### Create Factor

To create a factor, you can use the `createFactor` method. This is a low-level function to help you
to create a backup factor key based on the type of TSS Share you want to create. You can pass your
own factor key or let the SDK generate one for you.

This method helps you add additional factor to the user's account such as device factor, social
recovery, SMS OTP, authenticator, and more.

:::danger Note

You shouldn't create too many factors, we recommend a **maximum of 7 factors**.

:::

#### Parameters

| Name                 | Description                                                                                                                                                                                                                        |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `tssShareIndex`      | Takes in TSS Share type to define the type of share to be created. Available values are `.device`, and `.recovery`.                                                                                                                |
| `factorKey?`         | A hex string to be used for creating the factor factor. You can pass the hex generated from social recovery, or any other back up factor like authenticator app. By default, a random BN is generated and converted to hex string. |
| `factorDescription`  | The share description to be stored in Metadata. Available values are `.HashedShare`,`.SecurityQuestions`, `.DeviceShare`, `.SeedPhrase`, `.PasswordShare`, `.SocialShare`, `.Other`. Default value is `.Other`.                    |
| `additionalMetadata` | You can use this parameter if you wish to store additional metadata for the factor.                                                                                                                                                |

#### Usage

```swift
do {
  // Use the existing MPCCoreKit instance
  let factor = try await mpcCoreKit.createFactor(
    tssShareIndex: .DEVICE,
    factorKey: nil,
    factorDescription: .DeviceShare
  )
} catch {
  // Handle error
}
```

### Delete Factor

To delete a factor you can use the `deleteFactor` method. This method helps you delete the factor,
respective to the factor pub provided for the user's account.

You can get the factor pubs by using the [getAllFactorPubs](#get-all-factor-pubs) method. It will
throw an error if you try to delete the factor that is currently active within the state of the SDK.

Use the [inputFactorKey](#log-in-with-existing-factor) method to change the factor key in the
current state of the SDK before deleting the current active factor.

#### Parameters

| Name              | Description                                                                                                                 |
| ----------------- | --------------------------------------------------------------------------------------------------------------------------- |
| `deleteFactorPub` | The PubKey for the factor you want to delete. The SDK internally will retrieve the corresponding factory key and delete it. |
| `factorKey?`      | The factorKey of the factor you want to delete.                                                                             |

#### Usage

```swift
do {
  // Use the existing MPCCoreKit instance
  try await mpcCoreKit.deleteFactor(
    deleteFactorPub: "FACTOR_PUB_KEY_IN_HEX"
  )
} catch {
  // Handle error
}
```

### Get Current Factor Key

To retrieve the currently active factor within the state of the SDK you can use the
`getCurrentFactorKey` method.

```swift
do {
  // Use the existing MPCCoreKit instance
  let currentFactorKey = try await mpcCoreKit.getCurrentFactorKey();
} catch {
  // Handle error
}
```

### Get Device Factor

To retrieve the device factor key hex string, you can use the `getDeviceFactor` method. The method
will throw an error if the device factor is not available.

To set the device factor, you can use the [setDeviceFactor](#set-device-factor) method.

```swift
do {
  // Use the existing MPCCoreKit instance
  let deviceFactor = try await mpcCoreKit.getDeviceFactor();
} catch {
  // Handle error
}
```

### Set Device Factor

To set the device factor, you can use the `setDeviceFactor` method. The method only stores the
factor key in the storage layer, and does not create a factor. To create a new device factor, you
can use the [createFactor](#create-factor) method. Once the factor is created successfully, you can
store the factor key in the storage layer using this method.

```swift
do {
  let deviceFactor = try await mpcCoreKit.createFactor(
    tssShareIndex: .DEVICE,
    factorKey: nil,
    factorDescription: .DeviceShare
  )

  // Use the existing MPCCoreKit instance
  try await mpcCoreKit.setDeviceFactor(
    deviceFactor: deviceFactor
  )
} catch {
  // Handle error
}
```

### Get All Factor Pubs

This method helps you to retrieve the list of all factors PubKey for the account. This method is
useful when you want to delete a factor, or check if the factor is present in the account.

Please note, this method only returns list of factors PubKey, and doesn't contain the share
description and additional metadata. Please use the [getKeyDetails](#get-key-details) method to
retrieve the share description and additional metadata.

```swift
do {
  // Use the existing MPCCoreKit instance
  let factorPubs = try await mpcCoreKit.getAllFactorPubs();
} catch {
  // Handle error
}
```

## User & Wallet Account Methods

### Get Secp256k1 Public Key

To retrieve the Secp256k1 public key, you can use the `getPubKey` method. You can use this public
key to derive the EOA address.

```swift
do {
  // Use the existing MPCCoreKit instance
  let pubKey = try await mpcCoreKit.getPubKey();
} catch {
  // Handle error
}
```

### Get User Info

To retrive the user's information you can use the `getUserInfo` method. The methods returns the
user's information based on the idToken, and Web3Auth metadata like verifier, verifier Id.

```swift
// Use the existing MPCCoreKit instance
let userInfo: UserInfo? = mpcCoreKit.getUserInfo()
```

### Get Key Details

To retieve the MPCKeyDetails for the user account you can use the `getKeyDetails` methods. These key
details has information like total factors, required factors, and threshold. Learn more about the
[MpcKeyDetails](#mpckeydetails).

#### Usage

```swift
do {
  // Use the existing MPCCoreKit instance
  let keyDetails: MpcKeyDetails = try await mpcCoreKit.getKeyDetails()
} catch {
  // Handle error
}
```

#### MpcKeyDetails

| Name                | Description                                                                                                                                                       |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `tssPubKey`         | The TSS PubKey, you can also get the TSS PubKey using the [getPubKey](#get-secp256k1-public-key) method. The PubKey is in SEC1 format.                            |
| `metadataPubKey`    | Holds the information for the metadataPubKey.                                                                                                                     |
| `requiredFactors`   | Defines the number of factors required to access the account after authentication flow. User won't be able to access the account, unless the requiredFactors is 0 |
| `threshold`         | Defines the number of threshold set by the user, for instance is it 2/2. or 2/n. By default, the SDK starts with 2/2 flow.                                        |
| `shareDescriptions` | Holds a json encoded string of the share descriptions.                                                                                                            |
| `totalShares`       | Returns the total number shares for the account.                                                                                                                  |
| `totalFactors?`     | Defines the total factors created by the user.                                                                                                                    |

## Mnemonic Conversion Methods

### Mnemonic to Key

To convert 24 word mnemonic(seed phrase) into corresponding factor key, you can use the
`mnemonicToKey` method. This is helpful when you want to convert the 24 words mnemonic backup factor
to factor key.

```swift
do {
  // Use the existing MPCCoreKit instance
  let factorKeyHex = try mpcCoreKit.mnemonicToKey(
    shareMnemonic: "YOUR_24_WORD_MNEMONIC"
  );
} catch {
  // Handle error
}
```

### Key to Mnemonic

To convert the factor key hex string to a 24 words mnemonic, you can use the `keyToMnemonic` method.

```swift
do {
  let deviceFactorKey = try await mpcCoreKit.getDeviceFactor();
  // Use the existing MPCCoreKit instance
  let deviceFactorInMnemonics = try mpcCoreKit.keyToMnemonic(
    factorKey: deviceFactorKey
  );
} catch {
  // Handle error
}
```

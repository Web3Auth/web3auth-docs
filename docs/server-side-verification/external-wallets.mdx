---
title: External Wallets
displayed_sidebar: docs
description: "External Wallets | Documentation - Web3Auth"
---

---

For connecting External Wallets with the Server Side Verification Flow, we have the `Auth.js` SDK aka Sign-in with Web3. This way, while connecting
with your own wallet provider, you can use the Sign-in with Web3 (SIWW) to generate a jwt token for your user to authenticate them on the client side.
Checkout the full documentation of [Sign-in with Web3](https://siww.web3auth.io/).

## Getting SIWWeb3Message from the AuthJS Backend

---

For a user on `Ethereum` mainnet with the address `0x00C02Bad...` who wants to authenticate from `http://localhost:3000/login`.

:::note

Message fields are similar to [EIP-4361: Sign in with Ethereum](https://docs.login.xyz/general-information/siwe-overview/eip-4361#specification) . The
`nonce` field here is ignored and can be any random string.

:::

#### `POST` https://auth-js-backend.tor.us/siww/get

```json
{
  "network": "ethereum", // Valid networks: ethereum, solana, starkware
  "header": {
    "t": "eip191"
  },
  "payload": {
    "domain": "localhost:3000",
    "uri": "http://localhost:3000/login",
    "address": "0x00C02Bad...",
    "chainId": 1,
    "version": "1",
    "nonce": "does-not-matter-here",
    "issuedAt": "2022-01-27T17:09:38.578Z"
  }
}
```

> Code: `200 OK`

```json
{
  "success": true,
  "challenge": "<SIWE message>"
}
```

## Verify signed challenge

---

- Verifies the signed challenge message.
- Returns a JWT that can be used as authentication method

#### `POST` https://auth-js-backend.tor.us/siww/verify

```json
{
  "message": "localhost:3000 wants you to...", // The original challenge message from 'Get challenge message' endpoint
  "signature": {
    "s": "304402203a5b354ebc147...",
    "t": "eip191"
  },
  "network": "ethereum"
}
```

:::info

Signature format depends on network. Solana uses `base58`, the rest use `hex`

:::

:::note

The signed challenge is valid for only `120s`.

:::

> Code: `200 OK`

```json
{
  "success": true,
  "token": "eyJhbGciOiJFUz..." // JWT token
}
```

### Sample `idToken` payload

---

```json
{
  "iat": 1661158877,
  "issuer": "metamask",
  "audience": "web3auth-eth-react-demo.vercel.app",
  "wallets": [
    {
      "address": "0x809d4310d578649d8539e718030ee11e603ee8f3",
      "type": "ethereum"
    }
  ],
  "exp": 1661245277
}
```

## Verifying JWT

---

### Get JWK

> Retrieves the JWK set used to sign the issued JWTs

#### `GET` https://auth-js-backend.tor.us/jwks

#### Success Response Examples

> Code: `200 OK`

```json
{
  "keys": [
    {
      "kty": "EC",
      "crv": "P-256",
      "x": "JQBpb4rBEDZWaRN_2nekaSMlesVTFwuiQ7DN2BV0fxo",
      "y": "6Gdq4uOjlDa4hAftMRx22fTnP-jLv5tfsFZqKoWCHsk",
      "kid": "G6-iP7C_4NdppFwiEuckNCU_etFIVBBxxt4UH9cB9G0",
      "use": "sig",
      "alg": "ES256"
    }
  ]
}
```

### Verifying the JWT using the JWK

```javascript
import * as jose from "jose"

const jwks = jose.createRemoteJWKSet(new URL("https://auth-js-backend.tor.us/jwks"));
const jwtDecoded = await jose.jwtVerify(jwtToken, jwks, { algorithms: ["ES256"] });
const publicAddress = "ethereum, solana, starkware address"
// Incase of Non-Torus Users
if ((jwtDecoded.payload as any).wallets[0].address === publicAddress) {
  // Verified
}
```
